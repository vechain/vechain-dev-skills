# StarGate (NFT-Based Staking & Delegation)

## When to use this guidance

Use this guidance when the user asks about:

- Staking VET on VeChain
- StarGate NFTs and node tiers
- Validator delegation
- VTHO rewards from staking
- Boosting NFT maturity
- VeChain node management
- Legacy X Node or Economic Node migration

**Important**: VeChain StarGate is NOT a cross-chain bridge. It is VeChain's NFT-based staking platform launched as part of the Hayabusa phase (July 2025).

## What is StarGate?

StarGate is VeChain's staking protocol that replaces the legacy node structure with an NFT-based staking and delegation framework. Staked VET positions are represented as tradable ERC721 NFTs, enabling secondary market liquidity while preserving staking rewards.

### Key Features
- **Minimum entry**: 10,000 VET (Dawn tier)
- **Liquid staking**: NFTs are tradable on VeChain-based marketplaces
- **Validator delegation**: Delegate to validators and earn VTHO proportional to block production
- **On-chain governance**: NFTs serve as voting instruments for VeVote governance
- **Fully on-chain**: All staking logic is transparent and verifiable

### VTHO Generation Change
Under StarGate, **base VTHO rewards (generated passively by holding VET) no longer exist**. VTHO can only be generated by actively delegating to a validator.

## Staking Lifecycle

1. **Stake**: Select a node tier and lock the exact required VET. Protocol mints an NFT.
2. **Maturity Period**: Each NFT has a maturity countdown (2 to 90 days by tier). During maturity, the NFT cannot be delegated. Optionally **boost** (pay VTHO) to instantly mature.
3. **Delegation**: Once mature, delegate to a chosen validator. Delegation activates at the validator's next period.
4. **Reward Accumulation**: Delegated validator mines blocks; VTHO rewards are distributed to delegators weighted by tier multiplier.
5. **Claiming**: Rewards claimable at end of each validator period.
6. **Unstaking**: Burns NFT and returns staked VET. Only possible with no active delegation.

## NFT Tiers

### X Category (Limited Supply -- from legacy X Node migration)

| Tier | VET Required | Supply | Reward Multiplier |
|------|-------------|--------|-------------------|
| Mjolnir X | 15,600,000 | 158 | 5.0x |
| Thunder X | 5,600,000 | 180 | 4.0x |
| Strength X | 1,600,000 | 843 | 3.0x |
| VeThor X | 600,000 | 735 | 2.0x |

### Eco Category (Open to all)

| Tier | VET Required | Supply | Reward Multiplier | Maturity |
|------|-------------|--------|-------------------|----------|
| Mjolnir | 15,000,000 | 100 | 3.5x | 90 days |
| Thunder | 5,000,000 | 300 | 2.5x | - |
| Strength | large | Limited | 1.5x | - |
| Flash | 200,000 | - | 1.3x | 15 days |
| Lightning | 50,000 | - | 1.15x | 5 days |
| Dawn | 10,000 | - | 1.0x | 2 days |

## Validator System

- Validators stake minimum **25 million VET**
- Choose validation period of **7, 15, or 30 days**
- Block selection probability proportional to own stake + delegated VET
- Validators receive block rewards + 100% of transaction priority fees
- Validators offline for 7+ consecutive days are forcibly removed

## Smart Contract Architecture

Two primary contracts:

1. **Stargate.sol** -- Main entry point. Orchestrates staking, unstaking, delegation, and reward distribution.
2. **StargateNFT.sol** -- ERC721 upgradeable contract representing staking positions as NFTs.

## Contract Addresses

### Testnet

| Contract | Address |
|----------|---------|
| StarGate | `0x1E02B2953AdEfEC225cF0Ec49805b1146a4429C1` |
| StarGateNFT | `0x887d9102f0003f1724d8fd5d4fe95a11572fcd77` |

Mainnet addresses available at [docs.stargate.vechain.org/for-developers/contracts](https://docs.stargate.vechain.org/for-developers/contracts).

## Key API Functions

### Staking

```typescript
// Stake VET and mint an NFT
// _levelId specifies the tier (e.g., Dawn, Lightning, etc.)
// Requires exact VET amount as transaction value
await stargate.transact.stake(levelId, { value: requiredVET });

// Stake + immediately delegate (requires maturity or boost)
await stargate.transact.stakeAndDelegate(levelId, validatorId, { value: requiredVET });

// Combined: stake + boost (instant maturity, costs VTHO) + delegate
await stargate.transact.stakeAndBoostAndDelegate(levelId, validatorId, { value: requiredVET });
```

### Delegation

```typescript
// Delegate an NFT to a validator (active at validator's next period)
await stargate.transact.delegate(tokenId, validatorId);

// Remove delegation
await stargate.transact.undelegate(tokenId);
```

### Rewards

```typescript
// Claim accumulated VTHO rewards
await stargate.transact.claimRewards(tokenId);

// For multiple NFTs, use multi-clause transactions
const clauses = tokenIds.map(id => ({
    to: stargateAddress,
    value: '0x0',
    data: ABIContract.encodeFunctionInput(stargateABI, 'claimRewards', [id]),
}));

// Check accrued rewards (current period, not yet claimable)
const accrued = await stargate.call.getAccruedRewards(tokenId);
```

### Unstaking

```typescript
// Burns NFT, returns staked VET, auto-claims remaining rewards
// Only possible when no active delegation exists
await stargate.transact.unstake(tokenId);
```

### Boosting

```typescript
// Instantly mature an NFT by paying VTHO fee
// IMPORTANT: Approve VTHO spending on StargateNFT contract first
await vthoContract.transact.approve(stargateNFTAddress, boostFee);
await stargate.transact.boost(tokenId);
```

**Critical**: VTHO approval must be granted to the **StargateNFT contract** (not the Stargate contract) before boosting.

## Phase 2 Breaking Changes

In Phase 2, **delegation requires maturity to have elapsed first**. The combined `stakeAndBoostAndDelegate` flow (paying VTHO for instant boost) is the only way to bypass the maturity waiting period.

## Node Manager

NFT owners can assign a **Node Manager** (secondary wallet) with limited operational privileges (e.g., voting on VeVote) without transferring ownership of the NFT.

## Developer Resources

- **Documentation**: [docs.stargate.vechain.org](https://docs.stargate.vechain.org/)
- **GitHub**: [github.com/vechain/stargate-contracts](https://github.com/vechain/stargate-contracts)
- **StarGate dApp**: [app.stargate.vechain.org](https://app.stargate.vechain.org/)
- **API Reference**: [docs.stargate.vechain.org/for-developers/api](https://docs.stargate.vechain.org/for-developers/api)

## Security

StarGate contracts have undergone:
- **Hacken Audit** (October 2025) -- strong code quality, role-based access control
- **Trail of Bits Audit**
- **Immunefi Audit Competition** (up to $40,000 in rewards)
- **HackenProof DualDefense Contests** ($36,000 and $50,000)
